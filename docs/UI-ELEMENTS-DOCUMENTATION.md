# Документация UI элементов платформы AI Agent

## Оглавление
1. [Глобальные компоненты](#глобальные-компоненты)
2. [Элементы ввода](#элементы-ввода)
3. [Кнопки](#кнопки)
4. [Выпадающие списки](#выпадающие-списки)
5. [Модальные окна](#модальные-окна)
6. [Таблицы](#таблицы)
7. [Страницы и их элементы](#страницы-и-их-элементы)

---

## Глобальные компоненты

### Sidebar (Боковая панель навигации)
**Файл:** `components/Sidebar.tsx`

#### Элементы управления:

1. **Кнопка сворачивания/разворачивания**
   - **Иконка:** `ChevronLeft` / `ChevronRight`
   - **Расположение:** Верхний правый угол сайдбара
   - **Функция:** `setIsSidebarCollapsed(!isSidebarCollapsed)`
   - **Действие:** Сворачивает/разворачивает боковую панель
   - **Состояния:**
     - Развернут: показывает иконку `ChevronLeft`
     - Свернут: показывает иконку `ChevronRight`

2. **Навигационные кнопки (NavItem)**
   - **Тип:** Кнопка с иконкой и текстом
   - **Функция:** `onNavigate(page)`
   - **Действие:** Переключает активную страницу
   - **Состояния:**
     - Активна: `bg-blue-50 dark:bg-blue-900/20 text-blue-600`
     - Неактивна: `text-gray-600 dark:text-gray-400`
   - **Список страниц:**
     - Dashboard (Инфопанель)
     - Agents (Агенты ИИ)
     - Chat (Тестовый чат)
     - KB Categories (Категории базы знаний)
     - KB Articles (Статьи базы знаний)
     - Settings (Настройки аккаунта)
     - Billing (Тарифные планы)

3. **Группы разделов (GroupHeader)**
   - **Функция:** `toggle()` - сворачивает/разворачивает группу
   - **Иконки:** `ChevronDown` / `ChevronRight`
   - **Группы:**
     - "Агенты ИИ"
     - "База знаний"
     - "Аккаунт"

---

### Header (Шапка приложения)
**Файл:** `components/Header.tsx`

#### Элементы управления:

1. **Поле поиска**
   - **Тип:** `<input type="text">`
   - **Плейсхолдер:** "Поиск"
   - **Иконка:** `Search` (слева)
   - **Функция:** Глобальный поиск по платформе
   - **Класс:** Адаптивный (скрыт на мобильных `hidden md:block`)

2. **Кнопка уведомлений**
   - **Иконка:** `Bell`
   - **Функция:** `setIsNotificationsOpen(!isNotificationsOpen)`
   - **Действие:** Открывает выпадающее меню уведомлений
   - **Бейдж:** Показывает количество непрочитанных уведомлений

3. **Выпадающее меню уведомлений**
   - **Кнопки:**
     - "Отметить как прочитанное" - отмечает все уведомления прочитанными
     - "Удалить все" - `setNotifications([]); setNotificationCount(0)`
     - Кнопка "X" на каждом уведомлении - `handleDeleteNotification(id, e)`

4. **Аватар пользователя**
   - **Функция:** `setIsProfileOpen(!isProfileOpen)`
   - **Действие:** Открывает меню профиля
   - **Загрузка аватара:** `<input type="file" accept="image/*">`
   - **Функция загрузки:** `handleAvatarUpload(event)`

5. **Меню профиля**
   - **Переключатель темы (Theme Switcher):**
     - 3 кнопки: Light, Dark, System
     - **Функция:** `setTheme('light' | 'dark' | 'system')`
     - **Иконки:** `Sun`, `Moon`, `Monitor`
   - **Кнопка "Выйти":**
     - **Иконка:** `LogOut`
     - **Действие:** Выход из системы

---

### Toast (Уведомления)
**Файл:** `components/Toast.tsx`

#### Элементы:

1. **Toast уведомление**
   - **Типы:** `success`, `error`, `info`
   - **Функция закрытия:** `onClose(toast.id)`
   - **Автозакрытие:** 4000ms (4 секунды)
   - **Иконки:**
     - Success: `CheckCircle` (зеленая)
     - Error/Info: `CheckCircle` (синяя)

---

### ConfirmationModal (Модальное окно подтверждения)
**Файл:** `components/ConfirmationModal.tsx`

#### Элементы управления:

1. **Backdrop (Фон)**
   - **Действие клика:** `onCancel()` - закрывает модалку

2. **Кнопка закрытия (X)**
   - **Иконка:** `X`
   - **Функция:** `onCancel()`
   - **Расположение:** Верхний правый угол

3. **Кнопка "Отменить"**
   - **Функция:** `onCancel()`
   - **Стиль:** Secondary (серая рамка)

4. **Кнопка "Удалить"**
   - **Функция:** `onConfirm()`
   - **Стиль:** Danger (красная)
   - **Иконка в центре:** `Trash2` (большая иконка корзины)

---

## Элементы ввода

### 1. Текстовое поле (Input)
**Используется:** Везде в формах

#### Варианты:

**Стандартное поле:**
```tsx
<input
  type="text"
  className="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2.5 text-sm"
/>
```

**Поле с обязательной меткой:**
```tsx
<label>Название<span className="text-red-500">*</span></label>
```

**Поле поиска с иконкой:**
```tsx
<Search className="absolute left-3 top-1/2 -translate-y-1/2" />
<input className="pl-10 pr-4 py-1.5" />
```

---

### 2. Текстовая область (Textarea)
**Используется:** Для длинных текстов (инструкции агента, содержимое статей)

**Варианты:**
- Обычная: `min-h-[60px]` до `min-h-[320px]`
- С автоизменением размера: `resize-y`
- Моноширинная для кода: `font-mono leading-relaxed`

---

### 3. Числовое поле (Number Input)
**Используется:** Для ввода чисел (таймауты, лимиты)

```tsx
<input
  type="number"
  value={resumeTime}
  onChange={(e) => setResumeTime(parseInt(e.target.value))}
/>
```

---

### 4. Toggle (Переключатель)
**Используется:** Везде для включения/выключения функций

#### Структура:
```tsx
<button
  onClick={() => onChange(!checked)}
  className={`relative inline-flex h-5 w-9 rounded-full ${checked ? 'bg-blue-600' : 'bg-gray-200'}`}
>
  <span className={`h-4 w-4 rounded-full bg-white ${checked ? 'translate-x-4' : 'translate-x-0'}`} />
</button>
```

#### Примеры использования:
- **Активация агента:** `isActive`
- **Проверка перед отправкой:** `checkBeforeSend`
- **Все воронки:** `allStagesPipelines[pipeline.id]`
- **Все каналы:** `channelsAll`
- **Доступ к базе знаний:** `kbAllCategories`

---

### 5. Checkbox (Чекбокс)
**Используется:** В таблицах для множественного выбора

#### Кастомный стиль:
```tsx
<input
  type="checkbox"
  className="appearance-none w-4 h-4 rounded border border-gray-300 bg-white
    checked:bg-[#0078D4] checked:border-[#0078D4]
    checked:bg-[url('data:image/svg+xml...')]
    checked:bg-center checked:bg-no-repeat"
/>
```

#### Примеры:
- Выбор всех записей в таблице
- Выбор отдельных строк
- Выбор элементов в MultiSelect

---

## Кнопки

### 1. Primary Button (Основная кнопка)
**Используется:** Для главных действий

```tsx
<button className="bg-[#0078D4] hover:bg-[#006cbd] text-white px-4 py-2 rounded-md">
  Создать
</button>
```

**Примеры использования:**
- "Создать" (агента, категорию, статью)
- "Сохранить"
- "Отправить"
- "Выбрать план"

---

### 2. Secondary Button (Вторичная кнопка)
**Используется:** Для второстепенных действий

```tsx
<button className="bg-white dark:bg-gray-700 border border-gray-300 text-gray-700 hover:bg-gray-50">
  Отмена
</button>
```

**Примеры:**
- "Отмена"
- "Создать и Создать еще"
- Кнопки в таблицах

---

### 3. Danger Button (Опасная кнопка)
**Используется:** Для удаления

```tsx
<button className="bg-[#DC2626] hover:bg-red-700 text-white">
  Удалить
</button>
```

**Примеры:**
- "Удалить" (в модалках подтверждения)
- "Удалить" (в интерфейсе редактирования)

---

### 4. Ghost Button (Прозрачная кнопка)
**Используется:** Для неосновных действий

```tsx
<button className="text-gray-600 hover:text-gray-900 px-4 py-2">
  Отмена
</button>
```

---

### 5. Icon Button (Кнопка-иконка)
**Используется:** Для действий в таблицах и списках

```tsx
<button className="hover:text-blue-600 transition-colors">
  <Edit size={16} />
</button>
```

**Типы иконок:**
- `Edit` - редактирование
- `Copy` - копирование
- `Trash2` - удаление
- `Filter` - фильтры
- `LayoutGrid` - смена вида

---

### 6. Toggle Button (Кнопка-переключатель)
**Используется:** Для переключения между режимами

**Пример:** Billing - Monthly/Yearly
```tsx
<button className={billingCycle === 'monthly'
  ? 'bg-white text-gray-900 shadow-sm'
  : 'text-gray-500 hover:text-gray-700'
}>
  Ежемесячно
</button>
```

---

## Выпадающие списки

### 1. Native Select (Нативный select)
**Используется:** Простые выборы из списка

```tsx
<select className="border border-gray-300 rounded-md px-3 py-2.5 bg-white">
  <option value="дней">дней</option>
  <option value="часов">часов</option>
  <option value="минут">минут</option>
</select>
```

**Примеры:**
- Выбор единицы времени
- Выбор модели AI
- Выбор количества записей на странице

---

### 2. Custom Dropdown (Кастомный выпадающий список)
**Используется:** Для более сложных выборов

```tsx
<div className="relative group">
  <div className="cursor-pointer">
    <span>Выбрать...</span>
    <ChevronDown />
  </div>
  <div className="absolute hidden group-hover:block">
    {options.map(opt => <div key={opt.id}>{opt.name}</div>)}
  </div>
</div>
```

**Примеры:**
- Выбор родительской категории
- Выбор ответов ИИ в Billing

---

### 3. MultiSelect (Множественный выбор)
**Используется:** Для выбора нескольких элементов

**Компонент:** `AgentBasicSettings.tsx` (строка 103-143)

#### Структура:
1. **Триггер:**
   - Показывает выбранные элементы
   - Иконка `ChevronDown`

2. **Dropdown меню:**
   - Список доступных элементов
   - Чекбоксы для выбора
   - `CheckCircle` для выбранных

3. **Selected chips:**
   - Отображаются над триггером
   - Кнопка `X` для удаления

**Примеры использования:**
- Выбор этапов сделок
- Выбор каналов
- Выбор категорий базы знаний
- Выбор связанных статей

---

### 4. MultiSelect с чипами (Tags Input)
**Используется:** В создании статей для категорий

```tsx
<div className="flex flex-wrap gap-2">
  {selectedCategories.map(cat => (
    <span className="bg-blue-50 text-blue-700 px-2 py-1 rounded">
      {cat}
      <button onClick={() => removeCategory(cat)}>
        <X size={14} />
      </button>
    </span>
  ))}
</div>
```

---

## Модальные окна

### 1. Confirmation Modal
**Файл:** `components/ConfirmationModal.tsx`

**Используется для:**
- Подтверждения удаления агентов
- Подтверждения удаления категорий
- Подтверждения удаления статей

**Структура:**
- Backdrop с затемнением
- Иконка действия (Trash2)
- Заголовок
- Описание
- Две кнопки: "Отменить" и "Удалить"

---

### 2. Trigger Modal
**Файл:** `pages/AgentEditor.tsx` (триггеры)

**Размер:** `max-w-4xl`

**Секции:**
1. **Основная информация:**
   - Название триггера (input)
   - Toggle "Активно"

2. **Условия:**
   - Textarea для условия

3. **Действия:**
   - Динамический список действий
   - Кнопки добавления/удаления

4. **Настройки:**
   - Сообщение при отмене
   - Лимит выполнений

---

### 3. Chain Modal
**Файл:** `pages/AgentEditor.tsx` (цепочки)

**Размер:** `max-w-5xl`

**Секции:**
1. **Условия запуска:**
   - Toggle "Все этапы сделок"
   - MultiSelect этапов
   - Условие исключения

2. **Шаги цепочки:**
   - Динамический список шагов
   - Задержка (число + единица)
   - Действия для каждого шага

3. **График работы:**
   - Дни недели с toggle
   - Время начала/конца для каждого дня

4. **Настройки:**
   - Лимит выполнений

---

## Таблицы

### Общая структура таблиц

**Используется на страницах:**
- Agents
- KB Categories
- KB Articles

#### Элементы:

1. **Toolbar (Панель инструментов)**
   - Поле поиска
   - Кнопка фильтров с бейджем
   - Кнопка смены вида

2. **Selection Bar (Панель выбора)**
   - Показывается при выборе элементов
   - "Выбрано N записи"
   - "Выбрать все" - `selectAll()`
   - "Убрать выделение со всех" - `deselectAll()`

3. **Table Header (Заголовок таблицы)**
   - Checkbox для выбора всех
   - Колонки с сортировкой (ChevronDown)

4. **Table Rows (Строки)**
   - Checkbox для выбора строки
   - Данные строки
   - Действия (Edit, Copy, Trash2)
   - Toggle для активации (для агентов/статей)

5. **Pagination (Пагинация)**
   - "Показано с X по Y из Z"
   - Выбор количества на странице (10/25/50)

6. **Empty State (Пустое состояние)**
   - Иконка `X` в круге
   - Заголовок "Не найдено..."
   - Опциональная кнопка создания

---

## Страницы и их элементы

### 1. Dashboard
**Файл:** `pages/Dashboard.tsx`

**Элементы:**
- 4 карточки статистики с графиками прогресса
- 2 графика (LineChart из recharts)

---

### 2. Agents (Список агентов)
**Файл:** `pages/Agents.tsx`

**Кнопки:**
- "Создать" - `onCreateAgent()`

**Таблица:**
- Столбцы: Название, Активно (toggle), Дата создания
- Действия: Edit, Copy, Trash2
- Клик по строке - `onEditAgent(agent.id)`

---

### 3. Agent Create (Создание агента)
**Файл:** `pages/AgentCreate.tsx`

**Поля:**
- Название агента (обязательное)

**Кнопки:**
- "Создать" - создает и возвращает к списку
- "Создать и Создать еще" - создает и очищает форму
- "Отмена" - возврат без сохранения

---

### 4. Agent Editor (Редактор агента)
**Файл:** `pages/AgentEditor.tsx`

**Табы:**
1. **Основные (Main)**
   - Компонент: `AgentBasicSettings`
   - Секции:
     - Профиль агента
     - Взаимодействия
     - Настройки воронок
     - Каналы
     - База знаний

2. **Сделки и контакты (Deals)**
   - Компонент: `AgentDealsContacts`
   - Секции:
     - Настройки доступа к данным
     - Настройки ввода данных

3. **Триггеры (Triggers)**
   - Кнопка "Создать триггер"
   - Таблица триггеров
   - Модалка создания/редактирования

4. **Цепочки (Chains)**
   - Кнопка "Создать цепочку"
   - Таблица цепочек
   - Модалка создания/редактирования

5. **Интеграции (Integrations)**
   - Список интеграций (Kommo, Google Calendar)
   - Детальные настройки интеграций

6. **Дополнительно (Advanced)**
   - Выбор модели AI
   - Язык ответов
   - График работы
   - Креативность (slider)
   - Задержка ответа

---

### 5. Chat (Тестовый чат)
**Файл:** `pages/Chat.tsx`

**Элементы:**

1. **Область сообщений:**
   - Сообщения пользователя (справа, синие)
   - Сообщения бота (слева, белые)
   - Индикатор загрузки (3 точки)

2. **Область ввода:**
   - Select выбора агента
   - Textarea для сообщения
   - Кнопка "Отправить"
   - **Enter** - отправить, **Shift+Enter** - новая строка

---

### 6. Settings (Настройки)
**Файл:** `pages/Settings.tsx`

**Настройки:**

1. **Правила остановки агентов:**
   - Toggle: "Останавливать агентов ИИ в чате..."

2. **Правила автоматического возобновления:**
   - Число: Возобновить через
   - Select: Единица времени (дней/часов/минут)

**Кнопка:** "Сохранить изменения"

---

### 7. Billing (Тарифные планы)
**Файл:** `pages/Billing.tsx`

**Элементы:**

1. **Текущий план:**
   - Название плана
   - Статус
   - Оставшиеся дни
   - Прогресс использования
   - Кнопка "Управление подпиской"

2. **Контролы:**
   - Dropdown: Выбор количества ответов AI
   - Toggle: Monthly/Yearly

3. **Карточки планов:**
   - Launch, Scale, Max
   - Цена
   - Список возможностей
   - Кнопка выбора

4. **FAQ (Часто задаваемые вопросы):**
   - Аккордеоны с вопросами

---

### 8. KB Categories (Категории базы знаний)
**Файл:** `pages/KbCategories.tsx`

**Особенности:**

1. **Breadcrumbs (Хлебные крошки):**
   - Навигация по иерархии категорий
   - Кликабельные элементы

2. **Кнопка "Назад к родительской категории":**
   - Показывается внутри категории

3. **Таблица подкатегорий:**
   - Столбцы: Заголовок, Подкатегории (счет), Статьи (счет)
   - Действия: Edit, Copy, Trash2
   - Клик по строке - открывает категорию

4. **Таблица статей:**
   - Показывается только внутри категории
   - Поиск по статьям
   - Кнопка "Создать статью"

---

### 9. KB Category Create (Создание категории)
**Файл:** `pages/KbCategoryCreate.tsx`

**Поля:**

1. **Родительская категория:**
   - Custom dropdown
   - Можно выбрать null (корневая)
   - Кнопка "X" для очистки

2. **Заголовок:** (обязательное)

3. **Описание:** (опциональное)

**Кнопки:**
- "Создать" / "Сохранить"
- "Создать и Создать еще"
- "Отмена"

---

### 10. KB Articles (Статьи)
**Файл:** `pages/KbArticles.tsx`

**Toolbar:**
- Активные фильтры (чипы с кнопкой "X")
- Поиск
- Кнопка фильтров с бейджем
- Кнопка смены вида

**Таблица:**
- Столбцы: ID, Заголовок, Активно (toggle), Категории (ссылка), Связанные статьи, Дата создания
- Действия: Edit, Copy, Trash2

---

### 11. KB Article Create (Создание статьи)
**Файл:** `pages/KbArticleCreate.tsx`

**Поля:**

1. **Заголовок:** (обязательное)

2. **Toggle "Активно":**
   - По умолчанию включен

3. **Категории:** (обязательное)
   - Множественный выбор с чипами
   - По умолчанию: "Общее"

4. **Связанные статьи:**
   - Custom dropdown с checkbox
   - Множественный выбор
   - Отображение в чипах

5. **Содержимое:** (обязательное)
   - Textarea

6. **Отправить файлы:**
   - Drag & drop область
   - Кнопка "выберите"

**Кнопки:**
- "Создать" / "Сохранить"
- "Создать и Создать еще"
- "Отмена"

---

## Специальные паттерны

### 1. Аккордеоны
**Используется в:** AgentEditor, модалки

**Структура:**
```tsx
<div onClick={() => setIsOpen(!isOpen)}>
  <span>Заголовок</span>
  <ChevronDown className={isOpen ? 'rotate-180' : ''} />
</div>
{isOpen && <div>Содержимое</div>}
```

---

### 2. Dynamic Lists (Динамические списки)
**Используется для:** Правил обновления, действий триггеров, шагов цепочек

**Структура:**
- Список элементов с ID
- Кнопка "+" для добавления
- Кнопка "Trash2" для удаления
- Кнопки "ArrowUp" / "ArrowDown" для изменения порядка

**Функции:**
- `addRule(setter)` - добавляет элемент
- `removeRule(id, setter)` - удаляет элемент
- `updateRule(id, field, value, setter)` - обновляет поле

---

### 3. Conditional Rendering
**Используется для:** Показа/скрытия элементов

**Примеры:**
```tsx
{!channelsAll && (
  <MultiSelect ... />
)}

{currentCategory && (
  <div>Статьи в категории</div>
)}

{activeTab === 'main' && (
  <AgentBasicSettings ... />
)}
```

---

### 4. Stop Propagation
**Используется в:** Таблицах для предотвращения клика по строке

```tsx
<td onClick={(e) => e.stopPropagation()}>
  <button onClick={(e) => {
    e.stopPropagation();
    handleAction();
  }}>
    Действие
  </button>
</td>
```

---

## Dark Mode Support

Все элементы поддерживают темную тему с использованием Tailwind классов:

**Примеры:**
- `bg-white dark:bg-gray-800`
- `text-gray-900 dark:text-white`
- `border-gray-200 dark:border-gray-700`

**Переключение темы:**
Через меню профиля (Header)
- Функция: `setTheme('light' | 'dark' | 'system')`
- useEffect применяет класс к `document.documentElement`

---

## Валидация

### Обязательные поля
Отмечены красной звездочкой: `<span className="text-red-500">*</span>`

### Проверка перед сохранением
**Пример:**
```tsx
const handleCreate = () => {
  if (!title || !content || selectedCategories.length === 0) {
    return; // или alert()
  }
  // ... сохранение
};
```

---

## Accessibility

### Клавиатурная навигация
- Enter в textarea чата - отправка сообщения
- Shift+Enter - новая строка
- Tab для перемещения между полями

### Tooltips
Показываются при наведении на иконки в свернутом sidebar:
```tsx
title={isSidebarCollapsed ? label : undefined}
```

---

## Состояния загрузки

### Индикатор загрузки в чате
```tsx
{isLoading && (
  <div className="flex space-x-2">
    <div className="w-2 h-2 bg-gray-400 rounded-full animate-bounce" />
    <div className="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style={{ animationDelay: '150ms' }} />
    <div className="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style={{ animationDelay: '300ms' }} />
  </div>
)}
```

### Disabled состояния кнопок
```tsx
<button
  disabled={isLoading || !input.trim()}
  className="disabled:opacity-50 disabled:cursor-not-allowed"
>
  Отправить
</button>
```

---

## Резюме по взаимодействию пользователя

### Создание сущностей:
1. Нажать "Создать" в списке
2. Заполнить обязательные поля (помечены *)
3. Выбрать "Создать" или "Создать и Создать еще"

### Редактирование:
1. Кликнуть по строке таблицы ИЛИ кнопка Edit
2. Изменить данные
3. Нажать "Сохранить"

### Удаление:
1. Кнопка Trash2
2. Подтвердить в модалке
3. Получить toast уведомление

### Множественный выбор:
1. Чекбоксы в таблице
2. Появляется Selection Bar
3. Доступны массовые действия

### Навигация:
- Sidebar для основных разделов
- Breadcrumbs для иерархии
- Табы для подразделов (в AgentEditor)

---

**Дата создания документа:** 21 ноября 2025
**Версия платформы:** 1.0
**Автор:** Claude Code
